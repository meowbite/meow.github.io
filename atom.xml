<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>meowbite</title>
  
  <subtitle>认真生活~</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://meowbite.github.io/"/>
  <updated>2018-05-23T05:54:46.000Z</updated>
  <id>http://meowbite.github.io/</id>
  
  <author>
    <name>meow</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>linux运维进阶-free命令的学习</title>
    <link href="http://meowbite.github.io/2018/05/23/linux-free-md/"/>
    <id>http://meowbite.github.io/2018/05/23/linux-free-md/</id>
    <published>2018-05-23T03:39:10.000Z</published>
    <updated>2018-05-23T05:54:46.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="文档目的"><a href="#文档目的" class="headerlink" title="文档目的"></a>文档目的</h2><ul><li>深入学习free命令在运维中的使用</li><li>实战中总结常用命令，加深理解</li></ul><h2 id="场景再现"><a href="#场景再现" class="headerlink" title="场景再现"></a>场景再现</h2><pre><code>在生产环境中，我们使用了一台安装了docker的机器来做镜像。</code></pre><p>当同时执行大量docker build命令，并且Dockerfile引用的文件巨大时(大量数据会读入内存，使用完成后才释放)，会造成内存不够的报警。<br>此时需要运用free命令，查看系统状态和问题处理。</p><h2 id="free命令知识点总结"><a href="#free命令知识点总结" class="headerlink" title="free命令知识点总结"></a>free命令知识点总结</h2><p>与上述问题无关<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$free</div><div class="line">              total        used        free      shared  buff/cache   available</div><div class="line">Mem:      131777608     7835208      659484     4203836   123282916   117500900</div><div class="line">Swap:             0           0           0</div></pre></td></tr></table></figure></p><ul><li>buff: A buffer is something that has yet to be “written” to disk.</li><li>cache: A cache is something that has been “read” from the disk and stored for later use.</li><li>total  = used + free</li><li><p>释放掉被系统cache占用的数据:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">echo 3&gt;/proc/sys/vm/drop_caches</div></pre></td></tr></table></figure></li><li><p>free命令由procps.*.rpm提供（在Redhat系列的OS上）。free命令的所有输出值都是从/proc/meminfo中读出的。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$which free</div><div class="line">/bin/free</div><div class="line">$rpm -qf /bin/free</div><div class="line">procps-ng-3.3.10-3.el7.x86_64</div></pre></td></tr></table></figure></li></ul><h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><ul><li><a href="http://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/free.html" target="_blank" rel="external">http://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/free.html</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;文档目的&quot;&gt;&lt;a href=&quot;#文档目的&quot; class=&quot;headerlink&quot; title=&quot;文档目的&quot;&gt;&lt;/a&gt;文档目的&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;深入学习free命令在运维中的使用&lt;/li&gt;
&lt;li&gt;实战中总结常用命令，加深理解&lt;/li&gt;
&lt;/ul&gt;
&lt;h2
      
    
    </summary>
    
    
      <category term="linux运维进阶" scheme="http://meowbite.github.io/tags/linux%E8%BF%90%E7%BB%B4%E8%BF%9B%E9%98%B6/"/>
    
  </entry>
  
  <entry>
    <title>Centos 7.2 上安装docker CE 18.05</title>
    <link href="http://meowbite.github.io/2018/05/23/docker-install/"/>
    <id>http://meowbite.github.io/2018/05/23/docker-install/</id>
    <published>2018-05-23T02:44:01.000Z</published>
    <updated>2018-05-24T01:05:08.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="文档目的"><a href="#文档目的" class="headerlink" title="文档目的"></a>文档目的</h2><ul><li>记录搭建docker CE 18.05在centos 7.2上的安装过程</li></ul><h2 id="docker-CE-18-05-0-ce-install"><a href="#docker-CE-18-05-0-ce-install" class="headerlink" title="docker CE 18.05.0-ce install"></a>docker CE 18.05.0-ce install</h2><p>OS INFO</p><ul><li>OS-VERSION: CentOS Linux release 7.2.1511 (Core)</li><li>Kernel: Linux 99-22.test 3.10.0-514.16.1.el7.x86_64 #1 SMP Wed Apr 12 15:04:24 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux</li></ul><h2 id="Uninstall-old-version"><a href="#Uninstall-old-version" class="headerlink" title="Uninstall old version"></a>Uninstall old version</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">sudo yum remove docker \</div><div class="line">                  docker-client \</div><div class="line">                  docker-client-latest \</div><div class="line">                  docker-common \</div><div class="line">                  docker-latest \</div><div class="line">                  docker-latest-logrotate \</div><div class="line">                  docker-logrotate \</div><div class="line">                  docker-selinux \</div><div class="line">                  docker-engine-selinux \</div><div class="line">                  docker-engine</div></pre></td></tr></table></figure><h2 id="Install-required-packages"><a href="#Install-required-packages" class="headerlink" title="Install required packages"></a>Install required packages</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">sudo yum install -y yum-utils \</div><div class="line">  device-mapper-persistent-data \</div><div class="line">  lvm2</div></pre></td></tr></table></figure><h2 id="Enable-the-edge-or-test-repository-Optional"><a href="#Enable-the-edge-or-test-repository-Optional" class="headerlink" title="Enable the edge or test repository (Optional)"></a>Enable the edge or test repository (Optional)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">sudo yum-config-manager --enable docker-ce-edge \</div><div class="line">## sudo yum-config-manager --disable docker-ce-edge \</div><div class="line">## sudo yum-config-manager --enable docker-ce-test</div></pre></td></tr></table></figure><h2 id="List-avalible-Docker-CE-Packages"><a href="#List-avalible-Docker-CE-Packages" class="headerlink" title="List avalible Docker CE Packages"></a>List avalible Docker CE Packages</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">[root@99-22 ~]# yum list docker-ce --showduplicates | sort -r</div><div class="line">Loaded plugins: fastestmirror, langpacks</div><div class="line">Installed Packages</div><div class="line">docker-ce.x86_64            18.05.0.ce-3.el7.centos             installed       </div><div class="line">docker-ce.x86_64            18.05.0.ce-3.el7.centos             docker-ce-edge  </div><div class="line">docker-ce.x86_64            18.04.0.ce-3.el7.centos             docker-ce-edge  </div><div class="line">docker-ce.x86_64            18.03.1.ce-1.el7.centos             docker-ce-stable</div><div class="line">docker-ce.x86_64            18.03.1.ce-1.el7.centos             docker-ce-edge  </div><div class="line">docker-ce.x86_64            18.03.0.ce-1.el7.centos             docker-ce-stable</div><div class="line">docker-ce.x86_64            18.03.0.ce-1.el7.centos             docker-ce-edge  </div><div class="line">docker-ce.x86_64            18.02.0.ce-1.el7.centos             docker-ce-edge  </div><div class="line">docker-ce.x86_64            18.01.0.ce-1.el7.centos             docker-ce-edge  </div><div class="line">...</div><div class="line">Determining fastest mirrors</div><div class="line">Available Packages</div></pre></td></tr></table></figure><h2 id="Install-from-remote-repository"><a href="#Install-from-remote-repository" class="headerlink" title="Install from remote repository"></a>Install from remote repository</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo yum install docker-ce-18.05.0.ce -y</div></pre></td></tr></table></figure><h2 id="Or-Install-from-local-rpms"><a href="#Or-Install-from-local-rpms" class="headerlink" title="Or Install from local rpms"></a>Or Install from local rpms</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">curl -O https://download.docker.com/linux/centos/7/x86_64/edge/Packages/docker-ce-18.05.0.ce-3.el7.centos.x86_64.rpm \</div><div class="line">&amp;&amp; yum install docker-ce-18.05.0.ce-3.el7.centos.x86_64.rpm</div></pre></td></tr></table></figure><h2 id="Start-docker-service"><a href="#Start-docker-service" class="headerlink" title="Start docker service"></a>Start docker service</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo systemctl start docker</div></pre></td></tr></table></figure><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ul><li><p>xfs系统格式化的时候需要开启f_type 保障overlayfs性能</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">docker info</div><div class="line"> Supports d_type: true</div></pre></td></tr></table></figure></li><li><p>启动配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cat /usr/lib/systemd/system/docker.service</div><div class="line">ExecStart=/usr/bin/dockerd  --storage-opt overlay2.override_kernel_check=1\</div><div class="line"> --storage-driver=overlay2 --graph=/home/docker</div></pre></td></tr></table></figure></li></ul><h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><ul><li><a href="https://docs.docker.com/install/linux/docker-ce/centos/" target="_blank" rel="external">https://docs.docker.com/install/linux/docker-ce/centos/</a></li><li><a href="https://docs.docker.com/release-notes/docker-ce/" target="_blank" rel="external">https://docs.docker.com/release-notes/docker-ce/</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;文档目的&quot;&gt;&lt;a href=&quot;#文档目的&quot; class=&quot;headerlink&quot; title=&quot;文档目的&quot;&gt;&lt;/a&gt;文档目的&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;记录搭建docker CE 18.05在centos 7.2上的安装过程&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;
      
    
    </summary>
    
    
      <category term="docker" scheme="http://meowbite.github.io/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>docker-compose学习（一）</title>
    <link href="http://meowbite.github.io/2017/09/20/docker-compose/"/>
    <id>http://meowbite.github.io/2017/09/20/docker-compose/</id>
    <published>2017-09-20T02:44:01.000Z</published>
    <updated>2018-05-23T01:22:35.000Z</updated>
    
    <content type="html"><![CDATA[<p>Compose 是 Docker 官方编排（Orchestration）项目之一，负责实现对 Docker <em>容器集群</em> 的快速编排。在需要定义和运行多个 Docker 容器时使用。</p><p>其代码目前在 <a href="https://github.com/docker/compose" target="_blank" rel="external">https://github.com/docker/compose</a> 上开源。</p><p>Compose 项目由 Python 编写，实现上调用了 Docker 服务提供的 API 来对容器进行管理。因此，只要所操作的平台支持 Docker API，就可以在其上利用 Compose 来进行编排管理。</p><h2 id="重要概念"><a href="#重要概念" class="headerlink" title="重要概念"></a>重要概念</h2><ul><li>服务（service）：一个应用的容器，实际上可以包括若干运行相同镜像的容器实例。</li><li>项目(project)：由一组关联的应用容器组成的一个完整业务单元，在 docker-compose.yml 文件中定义。</li></ul><p>Compose 的默认管理对象是项目，通过子命令对项目中的一组容器进行便捷地生命周期管理。</p><p>在日常工作中，我们经常会遇到<em>多</em>个容器共同提供服务的场景。如：一个web服务，除了web服务器，还需要数据库。Compose刚好满足这样的需求，它允许用户通过 一个单独的 docker-compose.yml 模板文件（YAML 格式）来定义一组相关联的应用容器为一个项目（project）。</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><h3 id="二进制包安装"><a href="#二进制包安装" class="headerlink" title="二进制包安装"></a>二进制包安装</h3><p>官方网站上提供依据编译好的二进制包：<a href="https://github.com/docker/compose/releases" target="_blank" rel="external">https://github.com/docker/compose/releases</a></p><p>在linux系统中，我们一般直接下载编译好的二进制包来使用。</p><p>Compose file format compatibility matrix:</p><table><thead><tr><th style="text-align:left">Compose file format</th><th style="text-align:center">Docker Engine</th></tr></thead><tbody><tr><td style="text-align:left">3.3</td><td style="text-align:center">17.06.0+</td></tr><tr><td style="text-align:left">3.0-3.2</td><td style="text-align:center">1.13.0+</td></tr><tr><td style="text-align:left">2.3</td><td style="text-align:center">17.06.0+</td></tr><tr><td style="text-align:left">2.2</td><td style="text-align:center">1.13.0+</td></tr></tbody></table><p><code>`$ sudo curl -L https://github.com/docker/compose/releases/download/1.16.1/docker-compose-</code>uname -s<code>-</code>uname -m` &gt; /usr/local/bin/docker-compose</p><p>$ sudo chmod a+x /usr/local/bin/docker-compose</p><p>``</p><h3 id="PIP安装"><a href="#PIP安装" class="headerlink" title="PIP安装"></a>PIP安装</h3>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Compose 是 Docker 官方编排（Orchestration）项目之一，负责实现对 Docker &lt;em&gt;容器集群&lt;/em&gt; 的快速编排。在需要定义和运行多个 Docker 容器时使用。&lt;/p&gt;
&lt;p&gt;其代码目前在 &lt;a href=&quot;https://github.
      
    
    </summary>
    
    
      <category term="docker" scheme="http://meowbite.github.io/tags/docker/"/>
    
  </entry>
  
</feed>
